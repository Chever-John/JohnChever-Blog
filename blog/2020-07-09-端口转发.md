---
slug: 端口转发
title: 端口转发
authors: CheverJohn
tags: [Network]
---
# 端口转发（Port forwarding）

端口转发是**安全壳（ssh）**为了**网络安全通信**而使用的一种方法。

SSH可以利用**端口转发技术**来传输其他TCP/IP协议的**报文**

当使用这种方法的时候，SSH就为其他服务在**客户端**和**服务器**端**建立**了**一条安全的传输管道**。

**端口转发**利用本地客户机端口映射到服务器端口来工作

SSH可以映射所有的服务器端口到本地端口，但是1024以下的端口需要根用户权限。

在使用防火墙的网络中，如果设置了允许SSH服务通过（即开启了22端口），从而阻断了其他服务，则被阻断了的服务仍然可以通过端口转发技术转发数据包



## 简介

端口转发服务是由一组**端口转发规则定义**的策略。一个端口转发服务可以应用到一个或更多的虚拟机。然后虚拟机的入站网络访问就根据端口转发服务所定义的策略进行管理。可以根据需要指定一个或多个CIDR来过滤源lP地址，以允许来自特定IP地址的请求被转发  。

虚拟机可以应用任意数量的端口转发服务。端口转发服务也可以先定义好，但暂时不应用到虚拟机上。如果虚拟机属于多个网络，则只有在默认网络中定义的端口转发规则才会生效  。

不能使用端口转发打开弹性lP地址的端口。当使用弹性IP时，外部访问通过使用安全组来控制 。





### 区分端口映射和端口转发

端口映射场景：
外网主机A想访问内网主机B上的服务
端口转发场景：
外网主机A已经可以任意内网主机B上的端口，但是无法访问内网主机C上的端口
此时可以将C主机的端口到B主机的端口，那么外网主机A访问B主机的某某端口就相当于访问了C主机的某某
总结：
端口转发和端口映射原理是一样的只不过是应用场景不一样，假如我们将本机的端口转发到远程主机端口，我们可以叫端口映射，也可以叫端口转发，看下图【注意图上文字】
![图一](https://i.loli.net/2020/07/09/UcHk2OKbQw5AgME.png)



我们如果把本机可以访问到的任意 IP
 的端口转发到另外一台服务器的端口，我们叫他端口转发，看下图【注意图上文字】

![图二](https://i.loli.net/2020/07/09/tM6jfwBHRCXPWgK.png)







## 端口转发和代理工具

 Lcx
 Htran
 Netcat
 frp
 ngrok



